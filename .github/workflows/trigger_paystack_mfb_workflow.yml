name: Trigger Paystack-MFB web-app Workflow

on:
  push:
    branches:
      - main
jobs:
  trigger-workflow:
    name: Trigger Workflow in Paystack-MFB/web-app to fetch upstream changes
    runs-on: ubuntu-latest
    steps:
      - name: Generate GitHub App token
        id: generate_token
        uses: actions/create-github-app-token@df432ceedc7162793a195dd1713ff69aefc7379e #v2
        with:
          app-id: ${{ vars.APP_ID }}
          private-key: ${{ secrets.PRIVATE_KEY }}
          owner: Paystack-MFB
          repositories: web-app
          permission-actions: write
          permission-workflows: write

      - name: Trigger workflow in Paystack-MFB/web-app
        uses: benc-uk/workflow-dispatch@e2e5e9a103e331dad343f381a29e654aea3cf8fc #v1
        with:
          token: ${{ steps.generate_token.outputs.token }}
          repo: Paystack-MFB/web-app
          workflow: fetch-upstream-origin-changes.yml
          ref: main
